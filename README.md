# DO6_CICD

Проект по настройке CI/CD с GitLab Runner (GitLab CI, bash, SSH, SCP).

Процесс выполнения проекта описан в src/report.md. В корневой папке проекта лежит **.gitlab-ci.yml** (его копия - src/gitlab-ci.yml.copy) со следующими стадиями:

1. **compile** - компиляция исходного кода 
   
   Здесь происходит параллельная сборка утилит cat и grep, написанных на Си, с сохранением артифактов со сроком 30 дней. Компиляция осуществляется при помощи утилиты Make. Мейкфайлы лежат в ```src/cat``` и ```src/grep```.

2. **style** - тест кодстайла

   Тесты осуществляются при помощи скрипта ```src/style_test.sh```, в котором использована утилита clang-format. Скрипт теста копируется в папки с исходным кодом и запускается оттуда же.

3. **test** - Интеграционные тесты
    
    Проверка запускается скриптом```src/code_test.sh```. Прогоняются заранее созданные тесты из папок ```src/cat/tests_cat``` и ```src/grep/tests_grep```. Если в результате выполнения программ **cat** и **grep** вывод - ```fail - 0```, то он записывается в файлы ```cat_grep_fail.txt```, ```grep_grep_fail.txt```. Если хоть один из файлов пустой, значит ошибки есть и пайплайн фейлится. Если ошибки есть в первой программе, то проверка на этом останавливается, не доходя до второй.
  

4. **deploy** - стадия деплоя

   Деплой запускается вручную скриптом ```src/deploy.sh``` и работает с двумя машинами. Заранее было настроено ssh-соединение между ними. На данной стадии происходит копирование файлов, полученных после сборки программ с одной машины на другую при помощи ssh. В результате на второй машине появляются готовые к работе утилиты cat и grep.



